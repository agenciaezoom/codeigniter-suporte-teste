"use strict";function Assistencia(){this.markers=[],this.marker,this.init(),this.filters()}Assistencia.prototype.init=function(){var t=this;$("#map").length>0&&$.getScript("https://maps.googleapis.com/maps/api/js?key=AIzaSyBlYRX4JcJLzJQ4S8lnVZy6FdvipuszGKY").done(function(e,n){t.gmaps()})},Assistencia.prototype.filters=function(){var t=this;$(".select").on("change",function(){var e=$(this).val();if(e.length<=3)return!1;var n=$(".units-list");$.ajax({url:site_url+"contato/units",type:"POST",dataType:"html",data:{filter:e},success:function(e){n.html(e),t.gmaps()},error:function(t){console.log(t)}})})},Assistencia.prototype.gmaps=function(){var t=this,e=[];$(".units-item").each(function(t,n){var o=new google.maps.LatLng($(this).data("lat"),$(this).data("lng"));e.push({id:$(this).data("id"),coords:o})});var n=document.getElementById("map"),o={center:e[0].coords,zoom:15,scrollwheel:!1,draggable:!0,fullscreenControl:!1,mapTypeControl:!1,streetViewControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP},s=new google.maps.Map(n,o),i=new google.maps.MarkerImage(site_url+"application/modules/comum/assets/img/marker.png");e.forEach(function(e,n){var o=new google.maps.Marker({position:e.coords,map:s,icon:i,url:"http://maps.google.com/maps?q=loc:"+e.coords});google.maps.event.addListener(o,"click",function(){window.open(this.url,"_blank")}),t.markers[e.id]=o,0==n&&(t.marker=o)}),google.maps.event.addDomListener(window,"resize",function(){t.marker.setIcon(i),setTimeout(function(){s.panTo(t.marker.position)},5)}),$("#units").on("change",'[name="units"]',function(){var e=$(this).val(),n=$(".units-list");n.find(".units-item").hide(),n.find("#unit-"+e).show(),t.marker=t.markers[e],s.panTo(t.marker.position)})},$(document).ready(function(){new Assistencia});